!function(t,e){"function"==typeof define&&define.amd?define("sifter",e):"object"==typeof exports?module.exports=e():t.Sifter=e()}(this,function(){var t=function(t,e){this.items=t,this.settings=e||{diacritics:!0}};t.prototype.tokenize=function(t){if(!(t=a(String(t||"").toLowerCase()))||!t.length)return[];var e,n,i,o,s=[],r=t.split(/ +/);for(e=0,n=r.length;e<n;e++){if(i=l(r[e]),this.settings.diacritics)for(o in p)p.hasOwnProperty(o)&&(i=i.replace(new RegExp(o,"g"),p[o]));s.push({string:r[e],regex:new RegExp(i,"i")})}return s},t.prototype.iterator=function(t,e){(r(t)?Array.prototype.forEach||function(t){for(var e=0,n=this.length;e<n;e++)t(this[e],e,this)}:function(t){for(var e in this)this.hasOwnProperty(e)&&t(this[e],e,this)}).apply(t,[e])},t.prototype.getScoreFunction=function(t,e){var o,s,r,a;t=this.prepareSearch(t,e),s=t.tokens,o=t.options.fields,r=s.length,a=t.options.nesting;var l,p=function(t,e){var n,i;return t?-1===(i=(t=String(t||"")).search(e.regex))?0:(n=e.string.length/t.length,0===i&&(n+=.5),n):0},c=(l=o.length)?1===l?function(t,e){return p(g(e,o[0],a),t)}:function(t,e){for(var n=0,i=0;n<l;n++)i+=p(g(e,o[n],a),t);return i/l}:function(){return 0};return r?1===r?function(t){return c(s[0],t)}:"and"===t.options.conjunction?function(t){for(var e,n=0,i=0;n<r;n++){if((e=c(s[n],t))<=0)return 0;i+=e}return i/r}:function(t){for(var e=0,n=0;e<r;e++)n+=c(s[e],t);return n/r}:function(){return 0}},t.prototype.getSortFunction=function(t,n){var e,i,o,s,r,a,l,p,c,d,u;if(u=!(t=(o=this).prepareSearch(t,n)).query&&n.sort_empty||n.sort,c=function(t,e){return"$score"===t?e.score:g(o.items[e.id],t,n.nesting)},r=[],u)for(e=0,i=u.length;e<i;e++)(t.query||"$score"!==u[e].field)&&r.push(u[e]);if(t.query){for(d=!0,e=0,i=r.length;e<i;e++)if("$score"===r[e].field){d=!1;break}d&&r.unshift({field:"$score",direction:"desc"})}else for(e=0,i=r.length;e<i;e++)if("$score"===r[e].field){r.splice(e,1);break}for(p=[],e=0,i=r.length;e<i;e++)p.push("desc"===r[e].direction?-1:1);return(a=r.length)?1===a?(s=r[0].field,l=p[0],function(t,e){return l*h(c(s,t),c(s,e))}):function(t,e){var n,i,o;for(n=0;n<a;n++)if(o=r[n].field,i=p[n]*h(c(o,t),c(o,e)))return i;return 0}:null},t.prototype.prepareSearch=function(t,e){if("object"==typeof t)return t;var n=(e=s({},e)).fields,i=e.sort,o=e.sort_empty;return n&&!r(n)&&(e.fields=[n]),i&&!r(i)&&(e.sort=[i]),o&&!r(o)&&(e.sort_empty=[o]),{options:e,query:String(t||"").toLowerCase(),tokens:this.tokenize(t),total:0,items:[]}},t.prototype.search=function(t,n){var i,o,e,s,r=this;return o=this.prepareSearch(t,n),n=o.options,t=o.query,s=n.score||r.getScoreFunction(o),t.length?r.iterator(r.items,function(t,e){i=s(t),(!1===n.filter||0<i)&&o.items.push({score:i,id:e})}):r.iterator(r.items,function(t,e){o.items.push({score:1,id:e})}),(e=r.getSortFunction(o,n))&&o.items.sort(e),o.total=o.items.length,"number"==typeof n.limit&&(o.items=o.items.slice(0,n.limit)),o};var h=function(t,e){return"number"==typeof t&&"number"==typeof e?e<t?1:t<e?-1:0:(t=n(String(t||"")),(e=n(String(e||"")))<t?1:t<e?-1:0)},s=function(t,e){var n,i,o,s;for(n=1,i=arguments.length;n<i;n++)if(s=arguments[n])for(o in s)s.hasOwnProperty(o)&&(t[o]=s[o]);return t},g=function(t,e,n){if(t&&e){if(!n)return t[e];for(var i=e.split(".");i.length&&(t=t[i.shift()]););return t}},a=function(t){return(t+"").replace(/^\s+|\s+$|/g,"")},l=function(t){return(t+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},r=Array.isArray||"undefined"!=typeof $&&$.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},p={a:"[aá¸€á¸Ä‚ÄƒÃ‚Ã¢ÇÇŽÈºâ±¥È¦È§áº áº¡Ã„Ã¤Ã€Ã ÃÃ¡Ä€ÄÃƒÃ£Ã…Ã¥Ä…Ä„ÃƒÄ…Ä„]",b:"[bâ¢Î²Î’Bà¸¿ðŒá›’]",c:"[cÄ†Ä‡ÄˆÄ‰ÄŒÄÄŠÄ‹CÌ„cÌ„Ã‡Ã§á¸ˆá¸‰È»È¼Æ‡ÆˆÉ•á´„ï¼£ï½ƒ]",d:"[dÄŽÄá¸Šá¸‹á¸á¸‘á¸Œá¸á¸’á¸“á¸Žá¸ÄÄ‘DÌ¦dÌ¦Æ‰É–ÆŠÉ—Æ‹ÆŒáµ­á¶á¶‘È¡á´…ï¼¤ï½„Ã°]",e:"[eÃ‰Ã©ÃˆÃ¨ÃŠÃªá¸˜á¸™ÄšÄ›Ä”Ä•áº¼áº½á¸šá¸›áººáº»Ä–Ä—Ã‹Ã«Ä’Ä“È¨È©Ä˜Ä™á¶’É†É‡È„È…áº¾áº¿á»€á»á»„á»…á»‚á»ƒá¸œá¸á¸–á¸—á¸”á¸•È†È‡áº¸áº¹á»†á»‡â±¸á´‡ï¼¥ï½…É˜ÇÆÆÎµ]",f:"[fÆ‘Æ’á¸žá¸Ÿ]",g:"[gÉ¢â‚²Ç¤Ç¥ÄœÄÄžÄŸÄ¢Ä£Æ“É Ä Ä¡]",h:"[hÄ¤Ä¥Ä¦Ä§á¸¨á¸©áº–áº–á¸¤á¸¥á¸¢á¸£É¦Ê°Ç¶Æ•]",i:"[iÃÃ­ÃŒÃ¬Ä¬Ä­ÃŽÃ®ÇÇÃÃ¯á¸®á¸¯Ä¨Ä©Ä®Ä¯ÄªÄ«á»ˆá»‰ÈˆÈ‰ÈŠÈ‹á»Šá»‹á¸¬á¸­Æ—É¨É¨Ì†áµ»á¶–Ä°iIÄ±Éªï¼©ï½‰]",j:"[jÈ·Ä´ÄµÉˆÉ‰ÊÉŸÊ²]",k:"[kÆ˜Æ™ê€êá¸°á¸±Ç¨Ç©á¸²á¸³á¸´á¸µÎºÏ°â‚­]",l:"[lÅÅ‚Ä½Ä¾Ä»Ä¼Ä¹Äºá¸¶á¸·á¸¸á¸¹á¸¼á¸½á¸ºá¸»Ä¿Å€È½Æšâ± â±¡â±¢É«É¬á¶…É­È´ÊŸï¼¬ï½Œ]",n:"[nÅƒÅ„Ç¸Ç¹Å‡ÅˆÃ‘Ã±á¹„á¹…Å…Å†á¹†á¹‡á¹Šá¹‹á¹ˆá¹‰NÌˆnÌˆÆÉ²È Æžáµ°á¶‡É³ÈµÉ´ï¼®ï½ŽÅŠÅ‹]",o:"[oÃ˜Ã¸Ã–Ã¶Ã“Ã³Ã’Ã²Ã”Ã´Ç‘Ç’ÅÅ‘ÅŽÅÈ®È¯á»Œá»ÆŸÉµÆ Æ¡á»Žá»ÅŒÅÃ•ÃµÇªÇ«ÈŒÈÕ•Ö…]",p:"[pá¹”á¹•á¹–á¹—â±£áµ½Æ¤Æ¥áµ±]",q:"[qê–ê—Ê ÉŠÉ‹ê˜ê™qÌƒ]",r:"[rÅ”Å•ÉŒÉÅ˜Å™Å–Å—á¹˜á¹™ÈÈ‘È’È“á¹šá¹›â±¤É½]",s:"[sÅšÅ›á¹ á¹¡á¹¢á¹£êž¨êž©ÅœÅÅ Å¡ÅžÅŸÈ˜È™SÌˆsÌˆ]",t:"[tÅ¤Å¥á¹ªá¹«Å¢Å£á¹¬á¹­Æ®ÊˆÈšÈ›á¹°á¹±á¹®á¹¯Æ¬Æ­]",u:"[uÅ¬Å­É„Ê‰á»¤á»¥ÃœÃ¼ÃšÃºÃ™Ã¹Ã›Ã»Ç“Ç”Å°Å±Å¬Å­Æ¯Æ°á»¦á»§ÅªÅ«Å¨Å©Å²Å³È”È•âˆª]",v:"[vá¹¼á¹½á¹¾á¹¿Æ²Ê‹êžêŸâ±±Ê‹]",w:"[wáº‚áºƒáº€áºÅ´Åµáº„áº…áº†áº‡áºˆáº‰]",x:"[xáºŒáºáºŠáº‹Ï‡]",y:"[yÃÃ½á»²á»³Å¶Å·Å¸Ã¿á»¸á»¹áºŽáºá»´á»µÉŽÉÆ³Æ´]",z:"[zÅ¹Åºáºáº‘Å½Å¾Å»Å¼áº’áº“áº”áº•ÆµÆ¶]"},n=function(){var t,e,n,i,o="",s={};for(n in p)if(p.hasOwnProperty(n))for(o+=i=p[n].substring(2,p[n].length-1),t=0,e=i.length;t<e;t++)s[i.charAt(t)]=n;var r=new RegExp("["+o+"]","g");return function(t){return t.replace(r,function(t){return s[t]}).toLowerCase()}}();return t}),function(t,e){"function"==typeof define&&define.amd?define("microplugin",e):"object"==typeof exports?module.exports=e():t.MicroPlugin=e()}(this,function(){var t={mixin:function(i){i.plugins={},i.prototype.initializePlugins=function(t){var e,n,i,o=[];if(this.plugins={names:[],settings:{},requested:{},loaded:{}},s.isArray(t))for(e=0,n=t.length;e<n;e++)"string"==typeof t[e]?o.push(t[e]):(this.plugins.settings[t[e].name]=t[e].options,o.push(t[e].name));else if(t)for(i in t)t.hasOwnProperty(i)&&(this.plugins.settings[i]=t[i],o.push(i));for(;o.length;)this.require(o.shift())},i.prototype.loadPlugin=function(t){var e=this.plugins,n=i.plugins[t];if(!i.plugins.hasOwnProperty(t))throw new Error('Unable to find "'+t+'" plugin');e.requested[t]=!0,e.loaded[t]=n.fn.apply(this,[this.plugins.settings[t]||{}]),e.names.push(t)},i.prototype.require=function(t){var e=this.plugins;if(!this.plugins.loaded.hasOwnProperty(t)){if(e.requested[t])throw new Error('Plugin has circular dependency ("'+t+'")');this.loadPlugin(t)}return e.loaded[t]},i.define=function(t,e){i.plugins[t]={name:t,fn:e}}}},s={isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}};return t}),function(t,e){"function"==typeof define&&define.amd?define("selectize",["jquery","sifter","microplugin"],e):"object"==typeof exports?module.exports=e(require("jquery"),require("sifter"),require("microplugin")):t.Selectize=e(t.jQuery,t.Sifter,t.MicroPlugin)}(this,function(_,d,t){"use strict";var x=function(t,e){if("string"!=typeof e||e.length){var l="string"==typeof e?new RegExp(e,"i"):e,p=function(t){var e=0;if(3===t.nodeType){var n=t.data.search(l);if(0<=n&&0<t.data.length){var i=t.data.match(l),o=document.createElement("span");o.className="highlight";var s=t.splitText(n),r=(s.splitText(i[0].length),s.cloneNode(!0));o.appendChild(r),s.parentNode.replaceChild(o,s),e=1}}else if(1===t.nodeType&&t.childNodes&&!/(script|style)/i.test(t.tagName)&&("highlight"!==t.className||"SPAN"!==t.tagName))for(var a=0;a<t.childNodes.length;++a)a+=p(t.childNodes[a]);return e};return t.each(function(){p(this)})}};_.fn.removeHighlight=function(){return this.find("span.highlight").each(function(){this.parentNode.firstChild.nodeName;var t=this.parentNode;t.replaceChild(this.firstChild,this),t.normalize()}).end()};var i=function(){};i.prototype={on:function(t,e){this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(e)},off:function(t,e){var n=arguments.length;return 0===n?delete this._events:1===n?delete this._events[t]:(this._events=this._events||{},void(t in this._events!=!1&&this._events[t].splice(this._events[t].indexOf(e),1)))},trigger:function(t){if(this._events=this._events||{},t in this._events!=!1)for(var e=0;e<this._events[t].length;e++)this._events[t][e].apply(this,Array.prototype.slice.call(arguments,1))}},i.mixin=function(t){for(var e=["on","off","trigger"],n=0;n<e.length;n++)t.prototype[e[n]]=i.prototype[e[n]]};var O=/Mac/.test(navigator.userAgent),C=O?91:17,b=O?18:17,S=!/android/i.test(window.navigator.userAgent)&&!!document.createElement("input").validity,p=function(t){return void 0!==t},I=function(t){return null==t?null:"boolean"==typeof t?t?"1":"0":t+""},a=function(t){return(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},e={before:function(t,e,n){var i=t[e];t[e]=function(){return n.apply(t,arguments),i.apply(t,arguments)}},after:function(e,t,n){var i=e[t];e[t]=function(){var t=i.apply(e,arguments);return n.apply(e,arguments),t}}},n=function(e,n,t){var i,o=e.trigger,s={};for(i in e.trigger=function(){var t=arguments[0];if(-1===n.indexOf(t))return o.apply(e,arguments);s[t]=arguments},t.apply(e,[]),e.trigger=o,s)s.hasOwnProperty(i)&&o.apply(e,s[i])},u=function(t){var e={};if("selectionStart"in t)e.start=t.selectionStart,e.length=t.selectionEnd-e.start;else if(document.selection){t.focus();var n=document.selection.createRange(),i=document.selection.createRange().text.length;n.moveStart("character",-t.value.length),e.start=n.text.length-i,e.length=i}return e},F=function(c){var d=null,t=function(t,e){var n,i,o,s,r,a,l,p;e=e||{},(t=t||window.event||{}).metaKey||t.altKey||(e.force||!1!==c.data("grow"))&&(n=c.val(),t.type&&"keydown"===t.type.toLowerCase()&&(o=97<=(i=t.keyCode)&&i<=122||65<=i&&i<=90||48<=i&&i<=57||32===i,46===i||8===i?(p=u(c[0])).length?n=n.substring(0,p.start)+n.substring(p.start+p.length):8===i&&p.start?n=n.substring(0,p.start-1)+n.substring(p.start+1):46===i&&void 0!==p.start&&(n=n.substring(0,p.start)+n.substring(p.start+1)):o&&(a=t.shiftKey,l=String.fromCharCode(t.keyCode),n+=l=a?l.toUpperCase():l.toLowerCase())),s=c.attr("placeholder"),!n&&s&&(n=s),(r=function(t,e){if(!t)return 0;var n=_("<test>").css({position:"absolute",top:-99999,left:-99999,width:"auto",padding:0,whiteSpace:"pre"}).text(t).appendTo("body");!function(t,e,n){var i,o,s={};if(n)for(i=0,o=n.length;i<o;i++)s[n[i]]=t.css(n[i]);else s=t.css();e.css(s)}(e,n,["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"]);var i=n.width();return n.remove(),i}(n,c)+4)!==d&&(d=r,c.width(r),c.triggerHandler("resize")))};c.on("keydown keyup update blur",t),t()},w=function(t,e){var n,i,o,s,r=this;(s=t[0]).selectize=r;var a,l,p,c=window.getComputedStyle&&window.getComputedStyle(s,null);if(o=(o=c?c.getPropertyValue("direction"):s.currentStyle&&s.currentStyle.direction)||t.parents("[dir]:first").attr("dir")||"",_.extend(r,{order:0,settings:e,$input:t,tabIndex:t.attr("tabindex")||"",tagType:"select"===s.tagName.toLowerCase()?1:2,rtl:/rtl/i.test(o),eventNS:".selectize"+ ++w.count,highlightedValue:null,isOpen:!1,isDisabled:!1,isRequired:t.is("[required]"),isInvalid:!1,isLocked:!1,isFocused:!1,isInputHidden:!1,isSetup:!1,isShiftDown:!1,isCmdDown:!1,isCtrlDown:!1,ignoreFocus:!1,ignoreBlur:!1,ignoreHover:!1,hasOptions:!1,currentResults:null,lastValue:"",caretPos:0,loading:0,loadedSearches:{},$activeOption:null,$activeItems:[],optgroups:{},options:{},userOptions:{},items:[],renderCache:{},onSearchChange:null===e.loadThrottle?r.onSearchChange:(a=r.onSearchChange,l=e.loadThrottle,function(){var t=this,e=arguments;window.clearTimeout(p),p=window.setTimeout(function(){a.apply(t,e)},l)})}),r.sifter=new d(this.options,{diacritics:e.diacritics}),r.settings.options){for(n=0,i=r.settings.options.length;n<i;n++)r.registerOption(r.settings.options[n]);delete r.settings.options}if(r.settings.optgroups){for(n=0,i=r.settings.optgroups.length;n<i;n++)r.registerOptionGroup(r.settings.optgroups[n]);delete r.settings.optgroups}r.settings.mode=r.settings.mode||(1===r.settings.maxItems?"single":"multi"),"boolean"!=typeof r.settings.hideSelected&&(r.settings.hideSelected="multi"===r.settings.mode),r.initializePlugins(r.settings.plugins),r.setupCallbacks(),r.setupTemplates(),r.setup()};return i.mixin(w),void 0!==t?t.mixin(w):function(t,e){e||(e={});console.error("Selectize: "+t),e.explanation&&(console.group&&console.group(),console.error(e.explanation),console.group&&console.groupEnd())}("Dependency MicroPlugin is missing",{explanation:'Make sure you either: (1) are using the "standalone" version of Selectize, or (2) require MicroPlugin before you load Selectize.'}),_.extend(w.prototype,{setup:function(){var t,e,n,i,o,s,r,a,l,p,c,d,u,h,g=this,f=g.settings,v=g.eventNS,m=_(window),y=_(document),w=g.$input;if(r=g.settings.mode,a=w.attr("class")||"",t=_("<div>").addClass(f.wrapperClass).addClass(a).addClass(r),e=_("<div>").addClass(f.inputClass).addClass("items").appendTo(t),n=_('<input type="'+f.searchInputType+'" maxlength="'+f.maxLength+'" autocomplete="off" />').appendTo(e).attr("tabindex",w.is(":disabled")?"-1":g.tabIndex),s=_(f.dropdownParent||t),i=_("<div>").addClass(f.dropdownClass).addClass(r).hide().appendTo(s),o=_("<div>").addClass(f.dropdownContentClass).appendTo(i),(p=w.attr("id"))&&(n.attr("id",p+"-selectized"),_("label[for='"+p+"']").attr("for",p+"-selectized")),g.settings.copyClassesToDropdown&&i.addClass(a),t.css({width:w[0].style.width}),g.plugins.names.length&&(l="plugin-"+g.plugins.names.join(" plugin-"),t.addClass(l),i.addClass(l)),(null===f.maxItems||1<f.maxItems)&&1===g.tagType&&w.attr("multiple","multiple"),g.settings.placeholder&&n.attr("placeholder",f.placeholder),!g.settings.splitOn&&g.settings.delimiter){var $=g.settings.delimiter.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");g.settings.splitOn=new RegExp("\\s*"+$+"+\\s*")}w.attr("autocorrect")&&n.attr("autocorrect",w.attr("autocorrect")),w.attr("autocapitalize")&&n.attr("autocapitalize",w.attr("autocapitalize")),g.$wrapper=t,g.$control=e,g.$control_input=n,g.$dropdown=i,g.$dropdown_content=o,i.on("mouseenter mousedown click","[data-disabled]>[data-selectable]",function(t){t.stopImmediatePropagation()}),i.on("mouseenter","[data-selectable]",function(){return g.onOptionHover.apply(g,arguments)}),i.on("mousedown click","[data-selectable]",function(){return g.onOptionSelect.apply(g,arguments)}),d="mousedown",u="*:not(input)",h=function(){return g.onItemSelect.apply(g,arguments)},(c=e).on(d,u,function(t){for(var e=t.target;e&&e.parentNode!==c[0];)e=e.parentNode;return t.currentTarget=e,h.apply(this,[t])}),F(n),e.on({mousedown:function(){return g.onMouseDown.apply(g,arguments)},click:function(){return g.onClick.apply(g,arguments)}}),n.on({mousedown:function(t){t.stopPropagation()},keydown:function(){return g.onKeyDown.apply(g,arguments)},keyup:function(){return g.onKeyUp.apply(g,arguments)},keypress:function(){return g.onKeyPress.apply(g,arguments)},resize:function(){g.positionDropdown.apply(g,[])},blur:function(){return g.onBlur.apply(g,arguments)},focus:function(){return g.ignoreBlur=!1,g.onFocus.apply(g,arguments)},paste:function(){return g.onPaste.apply(g,arguments)}}),y.on("keydown"+v,function(t){g.isCmdDown=t[O?"metaKey":"ctrlKey"],g.isCtrlDown=t[O?"altKey":"ctrlKey"],g.isShiftDown=t.shiftKey}),y.on("keyup"+v,function(t){t.keyCode===b&&(g.isCtrlDown=!1),16===t.keyCode&&(g.isShiftDown=!1),t.keyCode===C&&(g.isCmdDown=!1)}),y.on("mousedown"+v,function(t){if(g.isFocused){if(t.target===g.$dropdown[0]||t.target.parentNode===g.$dropdown[0])return!1;g.$control.has(t.target).length||t.target===g.$control[0]||g.blur(t.target)}}),m.on(["scroll"+v,"resize"+v].join(" "),function(){g.isOpen&&g.positionDropdown.apply(g,arguments)}),m.on("mousemove"+v,function(){g.ignoreHover=!1}),this.revertSettings={$children:w.children().detach(),tabindex:w.attr("tabindex")},w.attr("tabindex",-1).hide().after(g.$wrapper),_.isArray(f.items)&&(g.setValue(f.items),delete f.items),S&&w.on("invalid"+v,function(t){t.preventDefault(),g.isInvalid=!0,g.refreshState()}),g.updateOriginalInput(),g.refreshItems(),g.refreshState(),g.updatePlaceholder(),g.isSetup=!0,w.is(":disabled")&&g.disable(),g.on("change",this.onChange),w.data("selectize",g),w.addClass("selectized"),g.trigger("initialize"),!0===f.preload&&g.onSearchChange("")},setupTemplates:function(){var n=this.settings.labelField,i=this.settings.optgroupLabelField,t={optgroup:function(t){return'<div class="optgroup">'+t.html+"</div>"},optgroup_header:function(t,e){return'<div class="optgroup-header">'+e(t[i])+"</div>"},option:function(t,e){return'<div class="option">'+e(t[n])+"</div>"},item:function(t,e){return'<div class="item">'+e(t[n])+"</div>"},option_create:function(t,e){return'<div class="create">Add <strong>'+e(t.input)+"</strong>&hellip;</div>"}};this.settings.render=_.extend({},t,this.settings.render)},setupCallbacks:function(){var t,e,n={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(t in n)n.hasOwnProperty(t)&&(e=this.settings[n[t]])&&this.on(t,e)},onClick:function(t){this.isFocused||(this.focus(),t.preventDefault())},onMouseDown:function(t){var e=this,n=t.isDefaultPrevented();_(t.target);if(e.isFocused){if(t.target!==e.$control_input[0])return"single"===e.settings.mode?e.isOpen?e.close():e.open():n||e.setActiveItem(null),!1}else n||window.setTimeout(function(){e.focus()},0)},onChange:function(){this.$input.trigger("change")},onPaste:function(t){var o=this;o.isFull()||o.isInputHidden||o.isLocked?t.preventDefault():o.settings.splitOn&&setTimeout(function(){var t=o.$control_input.val();if(t.match(o.settings.splitOn))for(var e=_.trim(t).split(o.settings.splitOn),n=0,i=e.length;n<i;n++)o.createItem(e[n])},0)},onKeyPress:function(t){if(this.isLocked)return t&&t.preventDefault();var e=String.fromCharCode(t.keyCode||t.which);return this.settings.create&&"multi"===this.settings.mode&&e===this.settings.delimiter?(this.createItem(),t.preventDefault(),!1):void 0},onKeyDown:function(t){t.target,this.$control_input[0];var e=this;if(e.isLocked)9!==t.keyCode&&t.preventDefault();else{switch(t.keyCode){case 65:if(e.isCmdDown)return void e.selectAll();break;case 27:return void(e.isOpen&&(t.preventDefault(),t.stopPropagation(),e.close()));case 78:if(!t.ctrlKey||t.altKey)break;case 40:if(!e.isOpen&&e.hasOptions)e.open();else if(e.$activeOption){e.ignoreHover=!0;var n=e.getAdjacentOption(e.$activeOption,1);n.length&&e.setActiveOption(n,!0,!0)}return void t.preventDefault();case 80:if(!t.ctrlKey||t.altKey)break;case 38:if(e.$activeOption){e.ignoreHover=!0;var i=e.getAdjacentOption(e.$activeOption,-1);i.length&&e.setActiveOption(i,!0,!0)}return void t.preventDefault();case 13:return void(e.isOpen&&e.$activeOption&&(e.onOptionSelect({currentTarget:e.$activeOption}),t.preventDefault()));case 37:return void e.advanceSelection(-1,t);case 39:return void e.advanceSelection(1,t);case 9:return e.settings.selectOnTab&&e.isOpen&&e.$activeOption&&(e.onOptionSelect({currentTarget:e.$activeOption}),e.isFull()||t.preventDefault()),void(e.settings.create&&e.createItem()&&t.preventDefault());case 8:case 46:return void e.deleteSelection(t)}!e.isFull()&&!e.isInputHidden||(O?t.metaKey:t.ctrlKey)||t.preventDefault()}},onKeyUp:function(t){var e=this;if(e.isLocked)return t&&t.preventDefault();var n=e.$control_input.val()||"";e.lastValue!==n&&(e.lastValue=n,e.onSearchChange(n),e.refreshOptions(),e.trigger("type",n))},onSearchChange:function(e){var n=this,i=n.settings.load;i&&(n.loadedSearches.hasOwnProperty(e)||(n.loadedSearches[e]=!0,n.load(function(t){i.apply(n,[e,t])})))},onFocus:function(t){var e=this,n=e.isFocused;if(e.isDisabled)return e.blur(),t&&t.preventDefault(),!1;e.ignoreFocus||(e.isFocused=!0,"focus"===e.settings.preload&&e.onSearchChange(""),n||e.trigger("focus"),e.$activeItems.length||(e.showInput(),e.setActiveItem(null),e.refreshOptions(!!e.settings.openOnFocus)),e.refreshState())},onBlur:function(t,e){var n=this;if(n.isFocused&&(n.isFocused=!1,!n.ignoreFocus)){if(!n.ignoreBlur&&document.activeElement===n.$dropdown_content[0])return n.ignoreBlur=!0,void n.onFocus(t);var i=function(){n.close(),n.setTextboxValue(""),n.setActiveItem(null),n.setActiveOption(null),n.setCaret(n.items.length),n.refreshState(),e&&e.focus&&e.focus(),n.ignoreFocus=!1,n.trigger("blur")};n.ignoreFocus=!0,n.settings.create&&n.settings.createOnBlur?n.createItem(null,!1,i):i()}},onOptionHover:function(t){this.ignoreHover||this.setActiveOption(t.currentTarget,!1)},onOptionSelect:function(t){var e,n,i=this;t.preventDefault&&(t.preventDefault(),t.stopPropagation()),(n=_(t.currentTarget)).hasClass("create")?i.createItem(null,function(){i.settings.closeAfterSelect&&i.close()}):void 0!==(e=n.attr("data-value"))&&(i.lastQuery=null,i.setTextboxValue(""),i.addItem(e),i.settings.closeAfterSelect?i.close():!i.settings.hideSelected&&t.type&&/mouse/.test(t.type)&&i.setActiveOption(i.getOption(e)))},onItemSelect:function(t){this.isLocked||"multi"===this.settings.mode&&(t.preventDefault(),this.setActiveItem(t.currentTarget,t))},load:function(t){var e=this,n=e.$wrapper.addClass(e.settings.loadingClass);e.loading++,t.apply(e,[function(t){e.loading=Math.max(e.loading-1,0),t&&t.length&&(e.addOption(t),e.refreshOptions(e.isFocused&&!e.isInputHidden)),e.loading||n.removeClass(e.settings.loadingClass),e.trigger("load",t)}])},setTextboxValue:function(t){var e=this.$control_input;e.val()!==t&&(e.val(t).triggerHandler("update"),this.lastValue=t)},getValue:function(){return 1===this.tagType&&this.$input.attr("multiple")?this.items:this.items.join(this.settings.delimiter)},setValue:function(t,e){n(this,e?[]:["change"],function(){this.clear(e),this.addItems(t,e)})},setActiveItem:function(t,e){var n,i,o,s,r,a,l,p,c=this;if("single"!==c.settings.mode){if(!(t=_(t)).length)return _(c.$activeItems).removeClass("active"),c.$activeItems=[],void(c.isFocused&&c.showInput());if("mousedown"===(n=e&&e.type.toLowerCase())&&c.isShiftDown&&c.$activeItems.length){for(p=c.$control.children(".active:last"),s=Array.prototype.indexOf.apply(c.$control[0].childNodes,[p[0]]),(r=Array.prototype.indexOf.apply(c.$control[0].childNodes,[t[0]]))<s&&(l=s,s=r,r=l),i=s;i<=r;i++)a=c.$control[0].childNodes[i],-1===c.$activeItems.indexOf(a)&&(_(a).addClass("active"),c.$activeItems.push(a));e.preventDefault()}else"mousedown"===n&&c.isCtrlDown||"keydown"===n&&this.isShiftDown?t.hasClass("active")?(o=c.$activeItems.indexOf(t[0]),c.$activeItems.splice(o,1),t.removeClass("active")):c.$activeItems.push(t.addClass("active")[0]):(_(c.$activeItems).removeClass("active"),c.$activeItems=[t.addClass("active")[0]]);c.hideInput(),this.isFocused||c.focus()}},setActiveOption:function(t,e,n){var i,o,s,r,a,l=this;l.$activeOption&&l.$activeOption.removeClass("active"),l.$activeOption=null,(t=_(t)).length&&(l.$activeOption=t.addClass("active"),!e&&p(e)||(i=l.$dropdown_content.height(),o=l.$activeOption.outerHeight(!0),e=l.$dropdown_content.scrollTop()||0,a=(r=s=l.$activeOption.offset().top-l.$dropdown_content.offset().top+e)-i+o,i+e<s+o?l.$dropdown_content.stop().animate({scrollTop:a},n?l.settings.scrollDuration:0):s<e&&l.$dropdown_content.stop().animate({scrollTop:r},n?l.settings.scrollDuration:0)))},selectAll:function(){var t=this;"single"!==t.settings.mode&&(t.$activeItems=Array.prototype.slice.apply(t.$control.children(":not(input)").addClass("active")),t.$activeItems.length&&(t.hideInput(),t.close()),t.focus())},hideInput:function(){this.setTextboxValue(""),this.$control_input.css({opacity:0,position:"absolute",left:this.rtl?1e4:-1e4}),this.isInputHidden=!0},showInput:function(){this.$control_input.css({opacity:1,position:"relative",left:0}),this.isInputHidden=!1},focus:function(){var t=this;t.isDisabled||(t.ignoreFocus=!0,t.$control_input[0].focus(),window.setTimeout(function(){t.ignoreFocus=!1,t.onFocus()},0))},blur:function(t){this.$control_input[0].blur(),this.onBlur(null,t)},getScoreFunction:function(t){return this.sifter.getScoreFunction(t,this.getSearchOptions())},getSearchOptions:function(){var t=this.settings,e=t.sortField;return"string"==typeof e&&(e=[{field:e}]),{fields:t.searchField,conjunction:t.searchConjunction,sort:e,nesting:t.nesting}},search:function(t){var e,n,i,o=this,s=o.settings,r=this.getSearchOptions();if(s.score&&"function"!=typeof(i=o.settings.score.apply(this,[t])))throw new Error('Selectize "score" setting must be a function that returns a function');if(t!==o.lastQuery?(o.lastQuery=t,n=o.sifter.search(t,_.extend(r,{score:i})),o.currentResults=n):n=_.extend(!0,{},o.currentResults),s.hideSelected)for(e=n.items.length-1;0<=e;e--)-1!==o.items.indexOf(I(n.items[e].id))&&n.items.splice(e,1);return n},refreshOptions:function(t){var e,n,i,o,s,r,a,l,p,c,d,u,h,g,f,v;void 0===t&&(t=!0);var m,y,w=this,$=_.trim(w.$control_input.val()),O=w.search($),C=w.$dropdown_content,b=w.$activeOption&&I(w.$activeOption.attr("data-value"));for(o=O.items.length,"number"==typeof w.settings.maxOptions&&(o=Math.min(o,w.settings.maxOptions)),s={},r=[],e=0;e<o;e++)for(a=w.options[O.items[e].id],l=w.render("option",a),p=a[w.settings.optgroupField]||"",n=0,i=(c=_.isArray(p)?p:[p])&&c.length;n<i;n++)p=c[n],w.optgroups.hasOwnProperty(p)||(p=""),s.hasOwnProperty(p)||(s[p]=document.createDocumentFragment(),r.push(p)),s[p].appendChild(l);for(this.settings.lockOptgroupOrder&&r.sort(function(t,e){return(w.optgroups[t].$order||0)-(w.optgroups[e].$order||0)}),d=document.createDocumentFragment(),e=0,o=r.length;e<o;e++)p=r[e],w.optgroups.hasOwnProperty(p)&&s[p].childNodes.length?((u=document.createDocumentFragment()).appendChild(w.render("optgroup_header",w.optgroups[p])),u.appendChild(s[p]),d.appendChild(w.render("optgroup",_.extend({},w.optgroups[p],{html:(m=u,y=void 0,y=document.createElement("div"),y.appendChild(m.cloneNode(!0)),y.innerHTML),dom:u})))):d.appendChild(s[p]);if(C.html(d),w.settings.highlight&&(C.removeHighlight(),O.query.length&&O.tokens.length))for(e=0,o=O.tokens.length;e<o;e++)x(C,O.tokens[e].regex);if(!w.settings.hideSelected)for(e=0,o=w.items.length;e<o;e++)w.getOption(w.items[e]).addClass("selected");(h=w.canCreate($))&&0===O.items.length&&(C.prepend(w.render("option_create",{input:$})),v=_(C[0].childNodes[0])),w.hasOptions=0<O.items.length||h,w.hasOptions?(0<O.items.length?((f=b&&w.getOption(b))&&f.length?g=f:"single"===w.settings.mode&&w.items.length&&(g=w.getOption(w.items[0])),g&&g.length||(g=v&&!w.settings.addPrecedence?w.getAdjacentOption(v,1):C.find("[data-selectable]:first"))):g=v,w.setActiveOption(g),t&&!w.isOpen&&w.open()):(w.setActiveOption(null),t&&w.isOpen&&w.close())},addOption:function(t){var e,n,i,o=this;if(_.isArray(t))for(e=0,n=t.length;e<n;e++)o.addOption(t[e]);else(i=o.registerOption(t))&&(o.userOptions[i]=!0,o.lastQuery=null,o.trigger("option_add",i,t))},registerOption:function(t){var e=I(t[this.settings.valueField]);return null!=e&&!this.options.hasOwnProperty(e)&&(t.$order=t.$order||++this.order,this.options[e]=t,e)},registerOptionGroup:function(t){var e=I(t[this.settings.optgroupValueField]);return!!e&&(t.$order=t.$order||++this.order,this.optgroups[e]=t,e)},addOptionGroup:function(t,e){e[this.settings.optgroupValueField]=t,(t=this.registerOptionGroup(e))&&this.trigger("optgroup_add",t,e)},removeOptionGroup:function(t){this.optgroups.hasOwnProperty(t)&&(delete this.optgroups[t],this.renderCache={},this.trigger("optgroup_remove",t))},clearOptionGroups:function(){this.optgroups={},this.renderCache={},this.trigger("optgroup_clear")},updateOption:function(t,e){var n,i,o,s,r,a,l,p=this;if(t=I(t),o=I(e[p.settings.valueField]),null!==t&&p.options.hasOwnProperty(t)){if("string"!=typeof o)throw new Error("Value must be set in option data");l=p.options[t].$order,o!==t&&(delete p.options[t],-1!==(s=p.items.indexOf(t))&&p.items.splice(s,1,o)),e.$order=e.$order||l,p.options[o]=e,r=p.renderCache.item,a=p.renderCache.option,r&&(delete r[t],delete r[o]),a&&(delete a[t],delete a[o]),-1!==p.items.indexOf(o)&&(n=p.getItem(t),i=_(p.render("item",e)),n.hasClass("active")&&i.addClass("active"),n.replaceWith(i)),p.lastQuery=null,p.isOpen&&p.refreshOptions(!1)}},removeOption:function(t,e){var n=this;t=I(t);var i=n.renderCache.item,o=n.renderCache.option;i&&delete i[t],o&&delete o[t],delete n.userOptions[t],delete n.options[t],n.lastQuery=null,n.trigger("option_remove",t),n.removeItem(t,e)},clearOptions:function(){var t=this;t.loadedSearches={},t.userOptions={},t.renderCache={},t.options=t.sifter.items={},t.lastQuery=null,t.trigger("option_clear"),t.clear()},getOption:function(t){return this.getElementWithValue(t,this.$dropdown_content.find("[data-selectable]"))},getAdjacentOption:function(t,e){var n=this.$dropdown.find("[data-selectable]"),i=n.index(t)+e;return 0<=i&&i<n.length?n.eq(i):_()},getElementWithValue:function(t,e){if(null!=(t=I(t)))for(var n=0,i=e.length;n<i;n++)if(e[n].getAttribute("data-value")===t)return _(e[n]);return _()},getItem:function(t){return this.getElementWithValue(t,this.$control.children())},addItems:function(t,e){for(var n=_.isArray(t)?t:[t],i=0,o=n.length;i<o;i++)this.isPending=i<o-1,this.addItem(n[i],e)},addItem:function(a,l){n(this,l?[]:["change"],function(){var t,e,n,i,o,s=this,r=s.settings.mode;a=I(a),-1===s.items.indexOf(a)?s.options.hasOwnProperty(a)&&("single"===r&&s.clear(l),"multi"===r&&s.isFull()||(t=_(s.render("item",s.options[a])),o=s.isFull(),s.items.splice(s.caretPos,0,a),s.insertAtCaret(t),(!s.isPending||!o&&s.isFull())&&s.refreshState(),s.isSetup&&(n=s.$dropdown_content.find("[data-selectable]"),s.isPending||(e=s.getOption(a),i=s.getAdjacentOption(e,1).attr("data-value"),s.refreshOptions(s.isFocused&&"single"!==r),i&&s.setActiveOption(s.getOption(i))),!n.length||s.isFull()?s.close():s.positionDropdown(),s.updatePlaceholder(),s.trigger("item_add",a,t),s.updateOriginalInput({silent:l})))):"single"===r&&s.close()})},removeItem:function(t,e){var n,i,o,s=this;n=t instanceof _?t:s.getItem(t),t=I(n.attr("data-value")),-1!==(i=s.items.indexOf(t))&&(n.remove(),n.hasClass("active")&&(o=s.$activeItems.indexOf(n[0]),s.$activeItems.splice(o,1)),s.items.splice(i,1),s.lastQuery=null,!s.settings.persist&&s.userOptions.hasOwnProperty(t)&&s.removeOption(t,e),i<s.caretPos&&s.setCaret(s.caretPos-1),s.refreshState(),s.updatePlaceholder(),s.updateOriginalInput({silent:e}),s.positionDropdown(),s.trigger("item_remove",t,n))},createItem:function(t,n){var i=this,o=i.caretPos;t=t||_.trim(i.$control_input.val()||"");var s=arguments[arguments.length-1];if("function"!=typeof s&&(s=function(){}),"boolean"!=typeof n&&(n=!0),!i.canCreate(t))return s(),!1;i.lock();var e,r,a="function"==typeof i.settings.create?this.settings.create:function(t){var e={};return e[i.settings.labelField]=t,e[i.settings.valueField]=t,e},l=(r=!(e=function(t){if(i.unlock(),!t||"object"!=typeof t)return s();var e=I(t[i.settings.valueField]);if("string"!=typeof e)return s();i.setTextboxValue(""),i.addOption(t),i.setCaret(o),i.addItem(e),i.refreshOptions(n&&"single"!==i.settings.mode),s(t)}),function(){r||(r=!0,e.apply(this,arguments))}),p=a.apply(this,[t,l]);return void 0!==p&&l(p),!0},refreshItems:function(){this.lastQuery=null,this.isSetup&&this.addItem(this.items),this.refreshState(),this.updateOriginalInput()},refreshState:function(){this.refreshValidityState(),this.refreshClasses()},refreshValidityState:function(){if(!this.isRequired)return!1;var t=!this.items.length;this.isInvalid=t,this.$control_input.prop("required",t),this.$input.prop("required",!t)},refreshClasses:function(){var t=this,e=t.isFull(),n=t.isLocked;t.$wrapper.toggleClass("rtl",t.rtl),t.$control.toggleClass("focus",t.isFocused).toggleClass("disabled",t.isDisabled).toggleClass("required",t.isRequired).toggleClass("invalid",t.isInvalid).toggleClass("locked",n).toggleClass("full",e).toggleClass("not-full",!e).toggleClass("input-active",t.isFocused&&!t.isInputHidden).toggleClass("dropdown-active",t.isOpen).toggleClass("has-options",!_.isEmptyObject(t.options)).toggleClass("has-items",0<t.items.length),t.$control_input.data("grow",!e&&!n)},isFull:function(){return null!==this.settings.maxItems&&this.items.length>=this.settings.maxItems},updateOriginalInput:function(t){var e,n,i,o,s=this;if(t=t||{},1===s.tagType){for(i=[],e=0,n=s.items.length;e<n;e++)o=s.options[s.items[e]][s.settings.labelField]||"",i.push('<option value="'+a(s.items[e])+'" selected="selected">'+a(o)+"</option>");i.length||this.$input.attr("multiple")||i.push('<option value="" selected="selected"></option>'),s.$input.html(i.join(""))}else s.$input.val(s.getValue()),s.$input.attr("value",s.$input.val());s.isSetup&&(t.silent||s.trigger("change",s.$input.val()))},updatePlaceholder:function(){if(this.settings.placeholder){var t=this.$control_input;this.items.length?t.removeAttr("placeholder"):t.attr("placeholder",this.settings.placeholder),t.triggerHandler("update",{force:!0})}},open:function(){var t=this;t.isLocked||t.isOpen||"multi"===t.settings.mode&&t.isFull()||(t.focus(),t.isOpen=!0,t.refreshState(),t.$dropdown.css({visibility:"hidden",display:"block"}),t.positionDropdown(),t.$dropdown.css({visibility:"visible"}),t.trigger("dropdown_open",t.$dropdown))},close:function(){var t=this,e=t.isOpen;"single"===t.settings.mode&&t.items.length&&(t.hideInput(),setTimeout(function(){t.$control_input.blur()})),t.isOpen=!1,t.$dropdown.hide(),t.setActiveOption(null),t.refreshState(),e&&t.trigger("dropdown_close",t.$dropdown)},positionDropdown:function(){var t=this.$control,e="body"===this.settings.dropdownParent?t.offset():t.position();e.top+=t.outerHeight(!0),this.$dropdown.css({width:t.outerWidth(),top:e.top,left:e.left})},clear:function(t){var e=this;e.items.length&&(e.$control.children(":not(input)").remove(),e.items=[],e.lastQuery=null,e.setCaret(0),e.setActiveItem(null),e.updatePlaceholder(),e.updateOriginalInput({silent:t}),e.refreshState(),e.showInput(),e.trigger("clear"))},insertAtCaret:function(t){var e=Math.min(this.caretPos,this.items.length);0===e?this.$control.prepend(t):_(this.$control[0].childNodes[e]).before(t),this.setCaret(e+1)},deleteSelection:function(t){var e,n,i,o,s,r,a,l,p,c=this;if(i=t&&8===t.keyCode?-1:1,o=u(c.$control_input[0]),c.$activeOption&&!c.settings.hideSelected&&(a=c.getAdjacentOption(c.$activeOption,-1).attr("data-value")),s=[],c.$activeItems.length){for(p=c.$control.children(".active:"+(0<i?"last":"first")),r=c.$control.children(":not(input)").index(p),0<i&&r++,e=0,n=c.$activeItems.length;e<n;e++)s.push(_(c.$activeItems[e]).attr("data-value"));t&&(t.preventDefault(),t.stopPropagation())}else(c.isFocused||"single"===c.settings.mode)&&c.items.length&&(i<0&&0===o.start&&0===o.length?s.push(c.items[c.caretPos-1]):0<i&&o.start===c.$control_input.val().length&&s.push(c.items[c.caretPos]));if(!s.length||"function"==typeof c.settings.onDelete&&!1===c.settings.onDelete.apply(c,[s]))return!1;for(void 0!==r&&c.setCaret(r);s.length;)c.removeItem(s.pop());return c.showInput(),c.positionDropdown(),c.refreshOptions(!0),a&&(l=c.getOption(a)).length&&c.setActiveOption(l),!0},advanceSelection:function(t,e){var n,i,o,s,r,a=this;0!==t&&(a.rtl&&(t*=-1),n=0<t?"last":"first",i=u(a.$control_input[0]),a.isFocused&&!a.isInputHidden?(s=a.$control_input.val().length,(t<0?0===i.start&&0===i.length:i.start===s)&&!s&&a.advanceCaret(t,e)):(r=a.$control.children(".active:"+n)).length&&(o=a.$control.children(":not(input)").index(r),a.setActiveItem(null),a.setCaret(0<t?o+1:o)))},advanceCaret:function(t,e){var n,i,o=this;0!==t&&(n=0<t?"next":"prev",o.isShiftDown?(i=o.$control_input[n]()).length&&(o.hideInput(),o.setActiveItem(i),e&&e.preventDefault()):o.setCaret(o.caretPos+t))},setCaret:function(t){var e,n,i,o,s=this;if(t="single"===s.settings.mode?s.items.length:Math.max(0,Math.min(s.items.length,t)),!s.isPending)for(e=0,n=(i=s.$control.children(":not(input)")).length;e<n;e++)o=_(i[e]).detach(),e<t?s.$control_input.before(o):s.$control.append(o);s.caretPos=t},lock:function(){this.close(),this.isLocked=!0,this.refreshState()},unlock:function(){this.isLocked=!1,this.refreshState()},disable:function(){this.$input.prop("disabled",!0),this.$control_input.prop("disabled",!0).prop("tabindex",-1),this.isDisabled=!0,this.lock()},enable:function(){var t=this;t.$input.prop("disabled",!1),t.$control_input.prop("disabled",!1).prop("tabindex",t.tabIndex),t.isDisabled=!1,t.unlock()},destroy:function(){var t=this,e=t.eventNS,n=t.revertSettings;t.trigger("destroy"),t.off(),t.$wrapper.remove(),t.$dropdown.remove(),t.$input.html("").append(n.$children).removeAttr("tabindex").removeClass("selectized").attr({tabindex:n.tabindex}).show(),t.$control_input.removeData("grow"),t.$input.removeData("selectize"),_(window).off(e),_(document).off(e),_(document.body).off(e),delete t.$input[0].selectize},render:function(t,e){var n,i,o="",s=!1,r=this;return"option"!==t&&"item"!==t||(s=!!(n=I(e[r.settings.valueField]))),s&&(p(r.renderCache[t])||(r.renderCache[t]={}),r.renderCache[t].hasOwnProperty(n))?r.renderCache[t][n]:(o=_(r.settings.render[t].apply(this,[e,a])),"option"===t||"option_create"===t?e[r.settings.disabledField]||o.attr("data-selectable",""):"optgroup"===t&&(i=e[r.settings.optgroupValueField]||"",o.attr("data-group",i),e[r.settings.disabledField]&&o.attr("data-disabled","")),"option"!==t&&"item"!==t||o.attr("data-value",n||""),s&&(r.renderCache[t][n]=o[0]),o[0])},clearCache:function(t){void 0===t?this.renderCache={}:delete this.renderCache[t]},canCreate:function(t){if(!this.settings.create)return!1;var e=this.settings.createFilter;return t.length&&("function"!=typeof e||e.apply(this,[t]))&&("string"!=typeof e||new RegExp(e).test(t))&&(!(e instanceof RegExp)||e.test(t))}}),w.count=0,w.defaults={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:!0,diacritics:!0,create:!1,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,maxOptions:1e3,maxItems:null,hideSelected:null,addPrecedence:!1,selectOnTab:!1,preload:!1,allowEmptyOption:!1,closeAfterSelect:!1,scrollDuration:60,loadThrottle:300,loadingClass:"loading",dataAttr:"data-data",optgroupField:"optgroup",valueField:"value",labelField:"text",disabledField:"disabled",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:!1,sortField:"$order",searchField:["text"],searchConjunction:"and",searchInputType:"text",maxLength:null,mode:null,wrapperClass:"selectize-control",inputClass:"selectize-input",dropdownClass:"selectize-dropdown",dropdownContentClass:"selectize-dropdown-content",dropdownParent:null,copyClassesToDropdown:!0,render:{}},_.fn.selectize=function(o){var s=_.fn.selectize.defaults,d=_.extend({},s,o),u=d.dataAttr,h=d.labelField,g=d.valueField,f=d.disabledField,v=d.optgroupField,m=d.optgroupLabelField,y=d.optgroupValueField;return this.each(function(){if(!this.selectize){var t=_(this),e=this.tagName.toLowerCase(),n=t.attr("placeholder")||t.attr("data-placeholder");n||d.allowEmptyOption||(n=t.children('option[value=""]').text());var i={placeholder:n,options:[],optgroups:[],items:[]};"select"===e?function(t,r){r.searchInputType=t.prop("type"),r.maxLength=t.prop("maxlength");var e,n,i,o,s=r.options,a={},l=function(t){var e=u&&t.attr(u);return"string"==typeof e&&e.length?JSON.parse(e):null},p=function(t,e){t=_(t);var n=I(t.val());if(n||d.allowEmptyOption)if(a.hasOwnProperty(n)){if(e){var i=a[n][v];i?_.isArray(i)?i.push(e):a[n][v]=[i,e]:a[n][v]=e}}else{var o=l(t)||{};o[h]=o[h]||t.text(),o[g]=o[g]||n,o[f]=o[f]||t.prop("disabled"),o[v]=o[v]||e,a[n]=o,s.push(o),t.is(":selected")&&r.items.push(n)}},c=function(t){var e,n,i,o,s;for((i=(t=_(t)).attr("label"))&&((o=l(t)||{})[m]=i,o[y]=i,o[f]=t.prop("disabled"),r.optgroups.push(o)),e=0,n=(s=_("option",t)).length;e<n;e++)p(s[e],i)};for(r.maxItems=t.attr("multiple")?null:1,e=0,n=(o=t.children()).length;e<n;e++)"optgroup"===(i=o[e].tagName.toLowerCase())?c(o[e]):"option"===i&&p(o[e])}(t,i):function(t,e){var n,i,o,s,r=t.attr(u);if(r)for(e.options=JSON.parse(r),n=0,i=e.options.length;n<i;n++)e.items.push(e.options[n][g]);else{var a=_.trim(t.val()||"");if(!d.allowEmptyOption&&!a.length)return;for(n=0,i=(o=a.split(d.delimiter)).length;n<i;n++)(s={})[h]=o[n],s[g]=o[n],e.options.push(s);e.items=o}}(t,i),new w(t,_.extend(!0,{},s,i,o))}})},_.fn.selectize.defaults=w.defaults,_.fn.selectize.support={validity:S},w.define("create_on_enter",function(){if("multi"===this.settings.mode){var e,n=this;this.onKeyUp=(e=n.onKeyUp,function(t){return 13===t.keyCode&&""!=this.$control_input.val().trim()&&n.createItem(this.$control_input.val()),e.apply(this,arguments)})}}),w.define("create_on_blur",function(){if("multi"===this.settings.mode){var e,n=this;this.onBlur=(e=n.onBlur,function(t){return""!=this.$control_input.val().trim()&&n.createItem(this.$control_input.val()),e.apply(this,arguments)})}}),w.define("drag_drop",function(t){if(!_.fn.sortable)throw new Error('The "drag_drop" plugin requires jQuery UI "sortable".');if("multi"===this.settings.mode){var e,n,i,o=this;o.lock=(e=o.lock,function(){var t=o.$control.data("sortable");return t&&t.disable(),e.apply(o,arguments)}),o.unlock=(n=o.unlock,function(){var t=o.$control.data("sortable");return t&&t.enable(),n.apply(o,arguments)}),o.setup=(i=o.setup,function(){i.apply(this,arguments);var n=o.$control.sortable({items:"[data-value]",forcePlaceholderSize:!0,disabled:o.isLocked,start:function(t,e){e.placeholder.css("width",e.helper.css("width")),n.css({overflow:"visible"})},stop:function(){n.css({overflow:"hidden"});var t=o.$activeItems?o.$activeItems.slice():null,e=[];n.children("[data-value]").each(function(){e.push(_(this).attr("data-value"))}),o.setValue(e),o.setActiveItem(t)}})})}}),w.define("dropdown_direction",function(t){var u=this;this.positionDropdown=function(){var t,e,n,i,o,s,r=this.$control,a=this.$dropdown,l=(t=u.$control,e=_(window),n=t.outerHeight(!1),i=t.offset().top-e.scrollTop(),{control:{height:n,above:i,below:e.height()-i-n},dropdown:{height:u.$dropdown.outerHeight(!1)}}),p=(o=l,"auto"===(s=u.settings.dropdownDirection)&&(s=o.control.below>o.dropdown.height?"down":o.control.above>o.control.below?"up":"down"),s);"up"===p?a.addClass("direction-up").removeClass("direction-down"):a.addClass("direction-down").removeClass("direction-up"),r.attr("data-dropdown-direction",p);var c,d="body"===this.settings.dropdownParent?r.offset():r.position();switch(p){case"up":d.top-=l.dropdown.height,l.dropdown.height>l.control.above&&(c=l.control.above-15);break;case"down":d.top+=l.control.height,l.dropdown.height>l.control.below&&(c=l.control.below-15)}c?this.$dropdown_content.css({"max-height":c}):this.$dropdown_content.css({"max-height":""}),this.$dropdown.css({width:r.outerWidth(),top:d.top,left:d.left})}}),w.define("dropdown_header",function(t){var e,n=this;t=_.extend({title:"Untitled",headerClass:"selectize-dropdown-header",titleRowClass:"selectize-dropdown-header-title",labelClass:"selectize-dropdown-header-label",closeClass:"selectize-dropdown-header-close",html:function(t){return'<div class="'+t.headerClass+'"><div class="'+t.titleRowClass+'"><span class="'+t.labelClass+'">'+t.title+'</span><a href="javascript:void(0)" class="'+t.closeClass+'">&times;</a></div></div>'}},t),n.setup=(e=n.setup,function(){e.apply(n,arguments),n.$dropdown_header=_(t.html(t)),n.$dropdown.prepend(n.$dropdown_header)})}),w.define("infinite_scroll",function(t){var e,n=this,o=1;n.infinitescroll={onScroll:function(){if(n.$dropdown_content[0].scrollHeight-(n.$dropdown_content.scrollTop()+n.$dropdown_content.height())<300){var t=JSON.stringify({search:n.lastValue,page:o});n.$dropdown_content.off("scroll"),n.onSearchChange(t)}}},n.onFocus=(e=n.onFocus,function(){var t=JSON.stringify({search:n.lastValue,page:o});e.apply(n,arguments),n.onSearchChange(t)}),n.onKeyUp=function(t){var e=this;if(e.isLocked)return t&&t.preventDefault();var n=e.$control_input.val()||"";if(e.lastValue!==n){var i=JSON.stringify({search:n,page:o=1});e.lastValue=n,e.onSearchChange(i),e.refreshOptions(),e.clearOptions(),e.trigger("type",n)}},n.on("load",function(){o++,n.$dropdown_content.on("scroll",n.infinitescroll.onScroll)})}),w.define("no_results",function(t){var e,n,i,o,s=this;t=_.extend({message:"Nenhum resultado encontrado.",html:function(t){return'<div class="selectize-dropdown '+t.classNames+' dropdown-empty-message"><div class="selectize-dropdown-content">'+t.message+"</div></div>"}},t),s.displayEmptyResultsMessage=function(){this.$empty_results_container&&(this.$empty_results_container.css("top",this.$control.outerHeight()),this.$empty_results_container.show())},s.refreshOptions=(e=s.refreshOptions,function(){e.apply(s,arguments),this.$empty_results_container&&(this.hasOptions||""==this.lastQuery?this.$empty_results_container.hide():this.displayEmptyResultsMessage())}),s.onKeyDown=(n=s.onKeyDown,function(t){n.apply(s,arguments),27===t.keyCode&&this.$empty_results_container.hide()}),s.onBlur=(i=s.onBlur,function(){this.$empty_results_container&&(i.apply(s,arguments),this.$empty_results_container.hide())}),s.setup=(o=s.setup,function(){o.apply(s,arguments),s.$empty_results_container=_(t.html(_.extend({classNames:s.$input.attr("class")},t))),s.$empty_results_container.insertBefore(s.$dropdown),s.$empty_results_container.hide()})}),w.define("optgroup_columns",function(a){var s,l=this;a=_.extend({equalizeWidth:!0,equalizeHeight:!0},a),this.getAdjacentOption=function(t,e){var n=t.closest("[data-group]").find("[data-selectable]"),i=n.index(t)+e;return 0<=i&&i<n.length?n.eq(i):_()},this.onKeyDown=(s=l.onKeyDown,function(t){var e,n,i,o;return!this.isOpen||37!==t.keyCode&&39!==t.keyCode?s.apply(this,arguments):(l.ignoreHover=!0,e=(o=this.$activeOption.closest("[data-group]")).find("[data-selectable]").index(this.$activeOption),void((n=(i=(o=37===t.keyCode?o.prev("[data-group]"):o.next("[data-group]")).find("[data-selectable]")).eq(Math.min(i.length-1,e))).length&&this.setActiveOption(n)))});var p=function(){var t,e=p.width,n=document;return void 0===e&&((t=n.createElement("div")).innerHTML='<div style="width:50px;height:50px;position:absolute;left:-50px;top:-50px;overflow:auto;"><div style="width:1px;height:100px;"></div></div>',t=t.firstChild,n.body.appendChild(t),e=p.width=t.offsetWidth-t.clientWidth,n.body.removeChild(t)),e},t=function(){var t,e,n,i,o,s,r;if((e=(r=_("[data-group]",l.$dropdown_content)).length)&&l.$dropdown_content.width()){if(a.equalizeHeight){for(t=n=0;t<e;t++)n=Math.max(n,r.eq(t).height());r.css({height:n})}a.equalizeWidth&&(s=l.$dropdown_content.innerWidth()-p(),i=Math.round(s/e),r.css({width:i}),1<e&&(o=s-i*(e-1),r.eq(e-1).css({width:o})))}};(a.equalizeHeight||a.equalizeWidth)&&(e.after(this,"positionDropdown",t),e.after(this,"refreshOptions",t))}),w.define("remove_button",function(t){t=_.extend({label:"&times;",title:"Remove",className:"remove",append:!0},t);var s,e,n,i,r;"single"!==this.settings.mode?(i=s=this,r='<a href="javascript:void(0)" class="'+(e=t).className+'" tabindex="-1" title="'+a(e.title)+'">'+e.label+"</a>",s.setup=(n=i.setup,function(){if(e.append){var o=i.settings.render.item;i.settings.render.item=function(t){return e=o.apply(s,arguments),n=r,i=e.search(/(<\/[^>]+>\s*)$/),e.substring(0,i)+n+e.substring(i);var e,n,i}}n.apply(s,arguments),s.$control.on("click","."+e.className,function(t){if(t.preventDefault(),!i.isLocked){var e=_(t.currentTarget).parent();i.setActiveItem(e),i.deleteSelection()&&i.setCaret(i.items.length)}})})):function(o,e){e.className="remove-single";var n,s=o,r='<a href="javascript:void(0)" class="'+e.className+'" tabindex="-1" title="'+a(e.title)+'">'+e.label+"</a>";o.setup=(n=s.setup,function(){if(e.append){var t=_(s.$input.context).attr("id"),i=(_("#"+t),s.settings.render.item);s.settings.render.item=function(t){return e=i.apply(o,arguments),n=r,_("<span>").append(e).append(n);var e,n}}n.apply(o,arguments),o.$control.on("click","."+e.className,function(t){t.preventDefault(),s.isLocked||s.clear()})})}(this,t)}),w.define("restore_on_backspace",function(i){var o,t=this;i.text=i.text||function(t){return t[this.settings.labelField]},this.onKeyDown=(o=t.onKeyDown,function(t){var e,n;return 8===t.keyCode&&""===this.$control_input.val()&&!this.$activeItems.length&&0<=(e=this.caretPos-1)&&e<this.items.length?(n=this.options[this.items[e]],this.deleteSelection(t)&&(this.setTextboxValue(i.text.apply(this,[n])),this.refreshOptions(!0)),void t.preventDefault()):o.apply(this,arguments)})}),w}),Selectize.define("click_to_edit",function(r){var e=this;r.text=r.text||function(t){return t[this.settings.labelField]},this.onClick=function(t){e.onClick;var o=1===e.settings.maxItems,s=o?"item active":"input active";return function(t){var e,n,i;if(t.target.className.indexOf(s)&&0<=(e=this.caretPos-1)&&e<this.items.length)return i=o?$(t.target).children().first().data("value"):$(t.target).data("value"),n=this.options[i],this.deleteSelection(t)&&(o&&this.removeItem(i),this.setTextboxValue(r.text.apply(this,[n])),this.refreshOptions(!0)),void t.preventDefault()}}()}),Selectize.define("condensed_dropdown",function(t){var i,o=this;this.onKeyDown=(i=o.onKeyDown,function(t){if((t.keyCode===KEY_LEFT||t.keyCode===KEY_RIGHT)&&o.$activeOption){o.ignoreHover=!0;var e=0;t.keyCode===KEY_LEFT&&(e=-1),t.keyCode===KEY_RIGHT&&(e=1);var n=o.getAdjacentOption(o.$activeOption,e);return n.length&&o.setActiveOption(n,!0,!0),void t.preventDefault()}return i.apply(this,arguments)})});